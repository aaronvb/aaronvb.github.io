{"componentChunkName":"component---src-templates-post-template-js","path":"/articles/request-hole","result":{"data":{"markdownRemark":{"id":"cdbcd540-6840-56ee-8adb-08d90a0a2223","html":"<p>I’ve been working on a few side projects where I needed to inspect webhooks and initially used RequestBin to do this. However, I had issues with their service being down a few times and had some concerns about privacy. The alternative CLI tools I found required language dependencies and were a bit of a hassle to set up.</p>\n<p>This felt like a good excuse to make a CLI tool in Go, which would require no dependencies or versions of languages; just compile, or download, the executable for your operating system.</p>\n<p>My initial goal for the tool was to expose an endpoint and print incoming requests to the terminal output and/or write to a log file. This was the first release of <a href=\"https://github.com/aaronvb/request_hole\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Request Hole</a>. (Also known as <code class=\"language-text\">rh</code>, which is the CLI executable.)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc994fb9fde2ed45f620b3dfe607cc06/80f66/rh-terminal-ui.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.08333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAADBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAExe7kiJMv/xAAaEAACAwEBAAAAAAAAAAAAAAACAwABBBMU/9oACAEBAAEFAtDDp/VkwlZIZjo2eAYhPEP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAfEAACAQMFAQAAAAAAAAAAAAAAAQIREiEiMTIzUZH/2gAIAQEABj8CnSct/Tsl9NTbyOV7yc2Wp1P/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAh8f/aAAgBAQABPyEIAHAZ7vJFS+rcuwqyby8FZ1a7/9oADAMBAAIAAwAAABB8D//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABYRAAMAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAgEBPxChf//EABsQAQEBAAIDAAAAAAAAAAAAAAERAFHRMcHw/9oACAEBAAE/EHvxEQDgN9J708jqlIc55O7BQuW6ubhVyTzOt//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/dc994fb9fde2ed45f620b3dfe607cc06/8ac56/rh-terminal-ui.webp 240w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/d3be9/rh-terminal-ui.webp 480w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/e46b2/rh-terminal-ui.webp 960w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/f992d/rh-terminal-ui.webp 1440w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/db549/rh-terminal-ui.webp 1576w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/dc994fb9fde2ed45f620b3dfe607cc06/09b79/rh-terminal-ui.jpg 240w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/7cc5e/rh-terminal-ui.jpg 480w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/6a068/rh-terminal-ui.jpg 960w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/644c5/rh-terminal-ui.jpg 1440w,\n/static/dc994fb9fde2ed45f620b3dfe607cc06/80f66/rh-terminal-ui.jpg 1576w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/dc994fb9fde2ed45f620b3dfe607cc06/6a068/rh-terminal-ui.jpg\"\n          alt=\"Request Hole Terminal UI\"\n          title=\"Request Hole Terminal UI\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Building the first release was relatively straight forward. It was working great and with the help of <a href=\"https://pterm.sh/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pterm</a> I was able to make the terminal output look modern. I later realized it would be a bit more useful to have a web interface that could show me the incoming requests, in real time, similar to RequestBin.</p>\n<p>This required a lot of refactoring as the architecture at that point didn’t support having two Goroutines (http servers in our case, one for the incoming requests and one to serve the web UI) running in parallel.</p>\n<p>From the very beginning I wanted Request Hole to have an interface for outputs called <code class=\"language-text\">renderers</code> that could be implemented by any renderer we want to add. This could be a terminal printer, a log writer, or a web UI. To add the web UI, I had to change the way renderers were called, which at the time was synchronous, and decided to move them into individual Goroutines where they could be run in parallel.</p>\n<p>By moving the renderers to Go routines, they needed a way to communicate with the incoming request endpoint so I utilized channels. I then moved all the renderer logic into a higher level function that manages all the Goroutines and channels.</p>\n<p>After the big refactor, the next step was to start serving the web UI. I decided on <a href=\"https://github.com/facebook/create-react-app\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">create-react-app</a> which provided mostly everything I needed to start building the front-end. Thankfully Go introduced the embed feature in 1.16 which made embedding and serving the front-end static files easy.</p>\n<p>The next big decision was to use GraphQL instead of a standard REST API. Pushing incoming requests to the front-end through websockets was a requirement and I had read about GraphQL’s subscriptions, so going with GraphQL felt like a good solution, and a fun experiment. Although not the easiest to setup, compared to a traditional REST API, and facing some weird quirks and nuances, I did manage to get all the plumbing sorted out with <a href=\"https://github.com/99designs/gqlgen\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">gqlgen</a> and <a href=\"https://www.apollographql.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apollo</a>.</p>\n<p>One thing I learned was that mapping Go types to GraphQL types don’t always, and most likely won’t, work out. The solution to that is to create custom types using scalars and once I figured that out everything went swimmingly. After getting GraphQL sorted out all that was left to do was to create the UI. I decided on Tailwind so I didn’t have to write any CSS.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d135462eb79eae7206e3892d16e925a6/c1595/rh-web-ui.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeuvAof/xAAaEAACAwEBAAAAAAAAAAAAAAAAAQIRExIx/9oACAEBAAEFAs4syiJcllnp/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAARAAEaEx/9oACAEBAAY/ArI2c1U//8QAHRAAAgEEAwAAAAAAAAAAAAAAAAERITFBYXGBkf/aAAgBAQABPyHcGw8CehaQqdjjYcRZH//aAAwDAQACAAMAAAAQuA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAdEAEBAAEEAwAAAAAAAAAAAAABEQAhMcHhQWGx/9oACAEBAAE/EGpCqr2ZpLD2fOKSi2DfuRVt0tw38+sswB43z//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/d135462eb79eae7206e3892d16e925a6/8ac56/rh-web-ui.webp 240w,\n/static/d135462eb79eae7206e3892d16e925a6/d3be9/rh-web-ui.webp 480w,\n/static/d135462eb79eae7206e3892d16e925a6/e46b2/rh-web-ui.webp 960w,\n/static/d135462eb79eae7206e3892d16e925a6/f992d/rh-web-ui.webp 1440w,\n/static/d135462eb79eae7206e3892d16e925a6/882b9/rh-web-ui.webp 1920w,\n/static/d135462eb79eae7206e3892d16e925a6/d3f94/rh-web-ui.webp 2272w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/d135462eb79eae7206e3892d16e925a6/09b79/rh-web-ui.jpg 240w,\n/static/d135462eb79eae7206e3892d16e925a6/7cc5e/rh-web-ui.jpg 480w,\n/static/d135462eb79eae7206e3892d16e925a6/6a068/rh-web-ui.jpg 960w,\n/static/d135462eb79eae7206e3892d16e925a6/644c5/rh-web-ui.jpg 1440w,\n/static/d135462eb79eae7206e3892d16e925a6/0f98f/rh-web-ui.jpg 1920w,\n/static/d135462eb79eae7206e3892d16e925a6/c1595/rh-web-ui.jpg 2272w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/d135462eb79eae7206e3892d16e925a6/6a068/rh-web-ui.jpg\"\n          alt=\"Request Hole Web UI\"\n          title=\"Request Hole Web UI\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>You can view the project at <a href=\"https://github.com/aaronvb/request_hole\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/aaronvb/request_hole</a> where the source and release files are available to download.</p>\n<p>If you’re on a Mac, you can install it with <code class=\"language-text\">brew install aaronvb/request_hole/rh</code>.</p>","fields":{"slug":"/articles/request-hole","tagSlugs":["/tag/code/","/tag/graph-ql/","/tag/go/","/tag/react/","/tag/cli/"]},"frontmatter":{"date":"2021-07-22","description":"Request Hole is a CLI tool and web UI for creating temporary endpoints for testing requests and webhooks.","tags":["Code","GraphQL","Go","React","CLI"],"title":"Request Hole, Testing Endpoints and Webhooks"}}},"pageContext":{"slug":"/articles/request-hole"}},"staticQueryHashes":["1251057998","251939775","401334301"]}
{"componentChunkName":"component---src-templates-post-template-js","path":"/articles/ember-js-flash-messages","result":{"data":{"markdownRemark":{"id":"14fe71bf-4f5a-5d2c-85c5-cadf8590ddbf","html":"<p>This is a simple way to create flash messages that are similar to the Ruby on Rails flash messages. I took from Yehuda Katz’s answer on <a href=\"https://stackoverflow.com/a/14301065/141190\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this Stack Overflow post</a>, and extended it to work with the updated controllerFor/needs changes and closing on transitions.</p>\n<h4 id=\"applicationhandlebars\" style=\"position:relative;\"><a href=\"#applicationhandlebars\" aria-label=\"applicationhandlebars permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>application.handlebars</h4>\n<div class=\"gatsby-highlight\" data-language=\"handlebars\"><pre class=\"language-handlebars\"><code class=\"language-handlebars\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token block keyword\">#if</span> <span class=\"token variable\">notification</span><span class=\"token delimiter punctuation\">}}</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\"><span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">bindAttr</span> <span class=\"token variable\">class</span><span class=\"token punctuation\">=</span><span class=\"token string\">\":alert notification.type\"</span><span class=\"token delimiter punctuation\">}}</span></span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>notification<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn-close<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">action</span> <span class=\"token string\">\"closeNotification\"</span><span class=\"token delimiter punctuation\">}}</span></span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token block keyword\">#if</span> <span class=\"token variable\">notification</span><span class=\"token punctuation\">.</span><span class=\"token variable\">title</span><span class=\"token delimiter punctuation\">}}</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span><span class=\"token punctuation\">></span></span><span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">notification</span><span class=\"token punctuation\">.</span><span class=\"token variable\">title</span><span class=\"token delimiter punctuation\">}}</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token block keyword\">/if</span><span class=\"token delimiter punctuation\">}}</span></span>\n    <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">notification</span><span class=\"token punctuation\">.</span><span class=\"token variable\">message</span><span class=\"token delimiter punctuation\">}}</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token block keyword\">/if</span><span class=\"token delimiter punctuation\">}}</span></span>\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">outlet</span><span class=\"token delimiter punctuation\">}}</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h4 id=\"application_controllerjscoffee\" style=\"position:relative;\"><a href=\"#application_controllerjscoffee\" aria-label=\"application_controllerjscoffee permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>application_controller.js.coffee</h4>\n<div class=\"gatsby-highlight\" data-language=\"coffee\"><pre class=\"language-coffee\"><code class=\"language-coffee\">App<span class=\"token punctuation\">.</span>ApplicationController <span class=\"token operator\">=</span> Ember<span class=\"token punctuation\">.</span>Controller<span class=\"token punctuation\">.</span><span class=\"token keyword\">extend</span>\n\n  <span class=\"token comment\"># close notification alert</span>\n  <span class=\"token comment\"># bind to action in template, example: {{action \"closeNotification\"}}</span>\n  <span class=\"token comment\"># detects if persists and closes on next transition</span>\n  #\n  <span class=\"token property\">closeNotification</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n    notification <span class=\"token operator\">=</span> @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'notification'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> notification\n      <span class=\"token keyword\">if</span> notification<span class=\"token punctuation\">.</span>persists\n        console<span class=\"token punctuation\">.</span>log <span class=\"token string\">\"Notification detected, clearing alert notification after next transition\"</span>\n        notification<span class=\"token punctuation\">.</span>persists <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n      <span class=\"token keyword\">else</span>\n        console<span class=\"token punctuation\">.</span>log <span class=\"token string\">\"Notification detected, clearing alert notification now\"</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'notification'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># notification alert</span>\n  <span class=\"token comment\"># type can be: error, info, success</span>\n  <span class=\"token comment\"># example: @get('controllers.application').notify({title: \"Error!\", message: \"An error occurred in foobar.\", type: \"alert-error\"})</span>\n  #\n  <span class=\"token property\">notify</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'notification'</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"posts_controllerjscoffee\" style=\"position:relative;\"><a href=\"#posts_controllerjscoffee\" aria-label=\"posts_controllerjscoffee permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>posts_controller.js.coffee</h4>\n<div class=\"gatsby-highlight\" data-language=\"coffee\"><pre class=\"language-coffee\"><code class=\"language-coffee\">App<span class=\"token punctuation\">.</span>PostsNewController <span class=\"token operator\">=</span> Ember<span class=\"token punctuation\">.</span>ObjectController<span class=\"token punctuation\">.</span><span class=\"token keyword\">extend</span>\n  <span class=\"token property\">needs</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"application\"</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># allows access to application controller functions</span>\n\n  <span class=\"token comment\"># post save</span>\n  #\n  <span class=\"token property\">save</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n    @<span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'model.title'</span><span class=\"token punctuation\">,</span> @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    @<span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'model.description'</span><span class=\"token punctuation\">,</span> @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'description'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    post <span class=\"token operator\">=</span> @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'model'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># if post is not valid, show flash message</span>\n    #\n    post<span class=\"token punctuation\">.</span><span class=\"token keyword\">on</span> <span class=\"token string\">'becameInvalid'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n      @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"controllers.application\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Error!\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">\"There was an error creating this post.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"alert-error\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># if post was created transition to posts index, show flash message and persist it to next transition</span>\n    #\n    post<span class=\"token punctuation\">.</span><span class=\"token keyword\">on</span> <span class=\"token string\">'didCreate'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n      @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"controllers.application\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"A new post!\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">\"<span class=\"token interpolation variable\">#{@get('model.title')}</span> was created.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"alert-success\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">persists</span><span class=\"token operator\">:</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      @<span class=\"token function\">transitionToRoute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts.index'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># commit post to server</span>\n    #\n    @<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'model.transaction'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"routerjscoffee\" style=\"position:relative;\"><a href=\"#routerjscoffee\" aria-label=\"routerjscoffee permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>router.js.coffee</h4>\n<div class=\"gatsby-highlight\" data-language=\"coffee\"><pre class=\"language-coffee\"><code class=\"language-coffee\">App<span class=\"token punctuation\">.</span>BeforeRoute <span class=\"token operator\">=</span> Ember<span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">.</span><span class=\"token keyword\">extend</span>\n  <span class=\"token comment\"># close any open notifcations before a route loads</span>\n  #\n  <span class=\"token property\">activate</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n    @<span class=\"token function\">controllerFor</span><span class=\"token punctuation\">(</span><span class=\"token string\">'application'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">closeNotification</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nApp<span class=\"token punctuation\">.</span>PostsIndexRoute <span class=\"token operator\">=</span> App<span class=\"token punctuation\">.</span>BeforeRoute<span class=\"token punctuation\">.</span><span class=\"token keyword\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>In the application.handlebars template I create a condition that checks if the notification variable is set, and if it is, display it with it’s message and alert-type class(error, success, info, etc).</p>\n<p>In the application controller, there’s a function that creates the notification and passes options to it, and there’s also a function that closes the notification. The closeNotification first checks for a ‘persists’ flag and if it doesn’t exist it sets the notification variable to null, which closes it. If a ‘persists’ flag does exist, it sets it the flag to null and skips closing the notification. On the next transition, the ‘persists’ flag wont exist and the notification will be closed.</p>\n<p>In the posts new controller, at the top I have a needs array, which let’s the controller know that we need access to the application controller. The notifications are hooked into the ‘on’ callbacks for the post model, and called by using @get(‘controllers.application’).notify(). In earlier versions of Ember.js you would directly use the controllerFor() function, but that was deprecated for ‘needs’.</p>\n<p>Lastly in the router, I created an App.BeforeRoute extension of Ember.Route which all of my routes extend from. This way every route will execute the activate function, which executes the closeNotification function, before every route loads.</p>","fields":{"slug":"/articles/ember-js-flash-messages","tagSlugs":["/tag/code/","/tag/ember-js/","/tag/coffee-script/"]},"frontmatter":{"date":"2016-03-30","description":null,"tags":["Code","Ember.js","CoffeeScript"],"title":"Ember.js Flash Messages"}}},"pageContext":{"slug":"/articles/ember-js-flash-messages"}},"staticQueryHashes":["1251057998","251939775","401334301"]}